import{N as v,g as y,s as h}from"./app-Yf_zpV-c.js";import{a as b}from"./authGuard-14YUcEvN.js";import{c as I}from"./utils-Blu-th2_.js";b();const i=new v,P=new URLSearchParams(window.location.search),U=P.get("user"),T=document.getElementById("profile-posts"),l=await i.profile.view(U,T);async function B(){F(l),x("profile-followers",l.followers,"This user has no followers"),x("profile-following",l.following,"This user follows no one"),L(l)}B();async function F(e){const o=document.getElementById("profile-info"),t=document.createElement("img");t.src=e.avatar.url,t.alt=e.avatar.alt||`${e.name}'s avatar image`;const n=document.createElement("div"),a=document.createElement("h2");a.textContent=e.name,n.append(a);const c=document.createElement("div");c.classList.add("numbers");const r=document.createElement("div"),s=document.createElement("p"),m=document.createElement("p");s.textContent=e._count.posts,m.textContent="Posts",r.append(s,m);const p=document.createElement("div"),d=document.createElement("p"),f=document.createElement("p");d.textContent=e._count.followers,f.textContent="Followers",p.append(d,f);const u=document.createElement("div"),w=document.createElement("p"),g=document.createElement("p");if(w.textContent=e._count.following,g.textContent="Following",u.append(w,g),c.append(r,p,u),o.append(t,n,c),e.bio){const E=document.createElement("p");E.textContent=e.bio,o.append(E)}o.append(await N())}function x(e,o,t){const n=document.getElementById(e);if(!o.length){const a=document.createElement("p");a.textContent=t,n.appendChild(a);return}o.forEach(a=>{const c=document.createElement("div"),r=document.createElement("img");r.src=a.avatar.url,r.alt=a.avatar.alt||`${a.name}'s avatar image`,r.style.cursor="pointer",r.addEventListener("click",()=>{window.location.href=`/profile/index.html?user=${encodeURIComponent(a.name)}`});const s=document.createElement("p");s.textContent=a.name,c.append(r,s),n.append(c)})}function L(e){const o=document.getElementById("profile-posts");if(e.posts.length===0){const t=document.createElement("p");t.textContent="This user has no posts",t.style.padding="2rem",o.append(t);return}e.posts.sort((t,n)=>new Date(n.created)-new Date(t.created)),e.posts.forEach(t=>{I(o,t,e)})}async function N(){const o=new URLSearchParams(window.location.search).get("user"),t=y(),n=document.createElement("button");return n.classList.add("btn","primary-border"),t===o?(n.textContent="Edit Profile",n.onclick=()=>{window.location.href=`/profile/edit.html?user=${encodeURIComponent(t)}`}):await C(n,o,t),n}async function C(e,o,t){try{const a=(await i.profile.view(t)).following.some(c=>c.name===o);e.textContent=a?"Unfollow":"Follow",e.onclick=async()=>{try{a?await i.profile.unfollow(o):await i.profile.follow(o),C(e,o,t)}catch{h("Error updating follow status","error")}}}catch{h("Error fetching user profile","error")}}
